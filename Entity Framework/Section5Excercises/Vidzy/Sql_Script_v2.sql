DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Vidzy.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202207212313142_InitialModel'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [int] NOT NULL,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207212313142_InitialModel', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400E55ADB6EE336107D2FD07F20F4D416592B97976D60EF227592C2E8E6823809FA1630D2D8214A512A4905F616FDB23EF493FA0B1DEA2E51B26537EBA42D1658D8D2DC3873381C1EE7AF3FFE1C7E5C049C3C83542C1423E760B0EF10105EE833311F39B19EBD7BEF7CFCF0F557C3333F5890FB5CEEC8C8A1A65023E749EBE8D87595F70401558380793254E14C0FBC3070A91FBA87FBFBDFBB07072EA009076D1132BC89856601245FF0EB38141E443AA6FC22F481ABEC39BE992656C9250D4045D4839173CFFCCF4B879C7046D1F914F8CC21548850538DA11DDF29986A198AF934C20794DF2E2340B919E50AB2908F4BF1BED1EF1F9AE8DD523137E5C54A87C186060F8EB274B84DF5AD92EA14E9C2849D6162F5D2AC3A49DAC8F91184C495373D1D8FB9345259420789D81E49BEEC1585463C987F7B641C731D4B180988B5A47C8F5CC78F9C793FC1F236FC05C448C49C57E3C048F05DED013EBA966104522F6F60964537F11DE2D6F5DCA662A156D149439F087D74E8904B744E1F391465AE2C73AA4309B8389054837F4DB5068955BA0C05589E1B7ECCFFB927C414EE08875CD0C5271073FD3472F0A343CED902FCFC49E6FD4E30DC40A8A465DC703274CBFAACAC1AD601C29EA52B65775FBFC4F7835DC556E124C616E1F5252FDDECA2F0659C5FC4DB257D66F344ADCDAF436E80276FD5138BD20E5729F14326742EC3E026E435A8A4EF1EA6612C3D83DCB043E096CA39E8FE712506D6C59509B5C695966F455CA9405B5C9BED989E9BE5FFD3E7263E24897A855E673B41000155708A11E6BECCE75B667C5B8BEB838213A5428F2519B01A67B653EA119D099FACDB366912EAF0C66C2032588458C03046CE77D65A5758CE715DB1DC6AF4C06902E94A9C62CE3490132F9D2EC65479D4B7338DF9F1EB4F107B204DF129C7F14A219A99D0365099F05844F99AD01B7A3D216EE22A3C34DF9C4204C2A0734D3DFAB8EE3A584C00859F46C2D6E567E856C0D51B736917EA818C464B7C41CCD57B69D3F29BC65C2DF4DD62AE568F3EAE574C3E2F8FB9B4FBA18E460D9065089F9387B0D02D271F5E85B2C34F65FDB9891E63740ABABA8B9443CA565B6F5616F8EAEA6532DB6C5461DDC750A70D4BBD92B2B660F281A922D6355435EBD8E3B028626FACDFC2448FE3A162ABDD4C0D1E28B7591EB2ECADCC434BFBEAD7C0FE591EEA2DAB696B933CE48342B1554A2AC14DB9849C73703B4887E1058D229C7F2A2444F6844C530662FC6EBAF93D3D486DB89E6AB9AE17D1169E709AA37368BC45D718E939934AE3DC441FA91993C67E6089D51A43C766CB5DD5F6BE5DAD7C0BE6E2E673A5FB0C5A774E99B3735C46601A6E329F36116EEB25940FE554B6CCC2E390C781E86EFCDDDAE9745BD54F9FD816866E2370ABB75B29B10EC57A827BA5BFBA6736AF41A5B76E5E8855CA5DF92CCFBE6A4EBB4FC46E4BE5E456B5D43DCFBD6E85B62ECEB675797B1BA4CB42ED6E5735547BB1E3725AA74153A4F05E9C0A8DEE3FCC3AF17A5EDA6ACDA988433051CF584B6CCBD3A5D2100C8CC060FA2B1F7386EB2D052EA86033503A651A9CC3FD83C306CFFD76386757299FF7219E77CE953093D29564C26AF6433C53E93D51F94D4017DF562DBD0C9BFBEFE15893445A978A09DE6B1623E7B744E9984C7E7EC8F5F6C89544141F937DF2FBC6156852AE7D9DE77A1B38DF90517C1D00AFA5F37683F05E1C9E8F9FF5AB7078D9D56EA7BC5ADB05666B02672BC2A46BD2FB82F4C87F8F85DB3133F6FAA8E99A435F1B356F8047B36FD53D88B26E9E2C1DFCB02F3E1A94A5FDB083D0E9E6D0D650686D3E56102FED8EBA29B64EF3B6E55DD06FB58C54E8837EF452073BF546D9353BDA9D2D7303F2CCBE16E1AEACFC510F7605C5E6A509F3273E02BCDA7E2C64266216E68DA111512ED298422E40531C3BE889D46C463D8DAF3D502AF9D9F29EF21845CE8247F027E22AD651AC71C9103CF2DACFA0A6BDACF29F3084F598875751F203F84B2C01C3646672BA123FC48CFB45DCE72D93538709D3B7B219D1D4529B5971BE2C2CD97F7CD065284B5FD16E6F2188381A5357624A9F619BD8EE147C8239F596F9EDB6DBC8FA42D4D33E3C65742E69A0321BA53E7E450CFBC1E2C3DF76C5B92FDB260000 , N'6.4.4')
END

IF @CurrentMigration < '202207212316438_PopulateGenreTable'
BEGIN
    
    INSERT INTO Genres (Id, Name)
    VALUES 
    	(1, 'Comedy'), 
    	(2, 'Action'), 
    	(3, 'Horror'), 
    	(4, 'Thriller'), 
    	(5, 'Family'), 
    	(6, 'Romance')
    
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207212316438_PopulateGenreTable', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400E55ADB6EE336107D2FD07F20F4D416592B97976D60EF227592C2E8E6823809FA1630D2D8214A512A4905F616FDB23EF493FA0B1DEA2E51B26537EBA42D1658D8D2DC3873381C1EE7AF3FFE1C7E5C049C3C83542C1423E760B0EF10105EE833311F39B19EBD7BEF7CFCF0F557C3333F5890FB5CEEC8C8A1A65023E749EBE8D87595F70401558380793254E14C0FBC3070A91FBA87FBFBDFBB07072EA009076D1132BC89856601245FF0EB38141E443AA6FC22F481ABEC39BE992656C9250D4045D4839173CFFCCF4B879C7046D1F914F8CC21548850538DA11DDF29986A198AF934C20794DF2E2340B919E50AB2908F4BF1BED1EF1F9AE8DD523137E5C54A87C186060F8EB274B84DF5AD92EA14E9C2849D6162F5D2AC3A49DAC8F91184C495373D1D8FB9345259420789D81E49BEEC1585463C987F7B641C731D4B180988B5A47C8F5CC78F9C793FC1F236FC05C448C49C57E3C048F05DED013EBA966104522F6F60964537F11DE2D6F5DCA662A156D149439F087D74E8904B744E1F391465AE2C73AA4309B8389054837F4DB5068955BA0C05589E1B7ECCFFB927C414EE08875CD0C5271073FD3472F0A343CED902FCFC49E6FD4E30DC40A8A465DC703274CBFAACAC1AD601C29EA52B65775FBFC4F7835DC556E124C616E1F5252FDDECA2F0659C5FC4DB257D66F344ADCDAF436E80276FD5138BD20E5729F14326742EC3E026E435A8A4EF1EA6612C3D83DCB043E096CA39E8FE712506D6C59509B5C695966F455CA9405B5C9BED989E9BE5FFD3E7263E24897A855E673B41000155708A11E6BECCE75B667C5B8BEB838213A5428F2519B01A67B653EA119D099FACDB366912EAF0C66C2032588458C03046CE77D65A5758CE715DB1DC6AF4C06902E94A9C62CE3490132F9D2EC65479D4B7338DF9F1EB4F107B204DF129C7F14A219A99D0365099F05844F99AD01B7A3D216EE22A3C34DF9C4204C2A0734D3DFAB8EE3A584C00859F46C2D6E567E856C0D51B736917EA818C464B7C41CCD57B69D3F29BC65C2DF4DD62AE568F3EAE574C3E2F8FB9B4FBA18E460D9065089F9387B0D02D271F5E85B2C34F65FDB9891E63740ABABA8B9443CA565B6F5616F8EAEA6532DB6C5461DDC750A70D4BBD92B2B660F281A922D6355435EBD8E3B028626FACDFC2448FE3A162ABDD4C0D1E28B7591EB2ECADCC434BFBEAD7C0FE591EEA2DAB696B933CE48342B1554A2AC14DB9849C73703B4887E1058D229C7F2A2444F6844C530662FC6EBAF93D3D486DB89E6AB9AE17D1169E709AA37368BC45D718E939934AE3DC441FA91993C67E6089D51A43C766CB5DD5F6BE5DAD7C0BE6E2E673A5FB0C5A774E99B3735C46601A6E329F36116EEB25940FE554B6CCC2E390C781E86EFCDDDAE9745BD54F9FD816866E2370ABB75B29B10EC57A827BA5BFBA6736AF41A5B76E5E8855CA5DF92CCFBE6A4EBB4FC46E4BE5E456B5D43DCFBD6E85B62ECEB675797B1BA4CB42ED6E5735547BB1E3725AA74153A4F05E9C0A8DEE3FCC3AF17A5EDA6ACDA988433051CF584B6CCBD3A5D2100C8CC060FA2B1F7386EB2D052EA86033503A651A9CC3FD83C306CFFD76386757299FF7219E77CE953093D29564C26AF6433C53E93D51F94D4017DF562DBD0C9BFBEFE15893445A978A09DE6B1623E7B744E9984C7E7EC8F5F6C89544141F937DF2FBC6156852AE7D9DE77A1B38DF90517C1D00AFA5F37683F05E1C9E8F9FF5AB7078D9D56EA7BC5ADB05666B02672BC2A46BD2FB82F4C87F8F85DB3133F6FAA8E99A435F1B356F8047B36FD53D88B26E9E2C1DFCB02F3E1A94A5FDB083D0E9E6D0D650686D3E56102FED8EBA29B64EF3B6E55DD06FB58C54E8837EF452073BF546D9353BDA9D2D7303F2CCBE16E1AEACFC510F7605C5E6A509F3273E02BCDA7E2C64266216E68DA111512ED298422E40531C3BE889D46C463D8DAF3D502AF9D9F29EF21845CE8247F027E22AD651AC71C9103CF2DACFA0A6BDACF29F3084F598875751F203F84B2C01C3646672BA123FC48CFB45DCE72D93538709D3B7B219D1D4529B5971BE2C2CD97F7CD065284B5FD16E6F2188381A5357624A9F619BD8EE147C8239F596F9EDB6DBC8FA42D4D33E3C65742E69A0321BA53E7E450CFBC1E2C3DF76C5B92FDB260000 , N'6.4.4')
END

IF @CurrentMigration < '202207212331044_AddGenreToVideoTable'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [int]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207212331044_AddGenreToVideoTable', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400E559DB6EE336107D2FD07F10F4D41659CB495EB686BD8BD4490AA39B0BA224E85B404B63872845A92415D85BF4CBFAD04FEA2F74A8BB48D996DD6E52A00810D8E25CCF0CE722FFF5C79FE38FAB88392F20248DF9C43D1E0C5D07781087942F276EAA16EFDEBB1F3F7CFDD5F8228C56CE634977AAE99093CB89FBAC5432F23C193C4344E420A2818865BC5083208E3C12C6DEC970F8BD777CEC018A705196E38CEF52AE6804D917FC3A8D7900894A09BB8A4360B2788E277E26D5B92611C8840430711F69F879ED3A678C1254EE035BB80EE13C5644A169A30709BE12315FFA093E20EC7E9D00D22D089350983CAAC9FB5A3F3CD1D67B3563292A48A58AA33D051E9F16707826FB41A0BA155C08D80502ABD6DAEB0CB489FB2370819E9B9A465326345501E820233B72B22F4755A0311FF4DF91334D994A054C38A44A1076E4DCA67346839F607D1FFF027CC253C69A76A02578D67A808F6E459C8050EB3B5814D6CD42D7F1DA7C9EC958B1357872D3675C9D9EB8CE352A27730655981B6EFA2A1680CE81200AC25BA214088CD275CCC1D26CE8D1FF4B4D985378235CE78AAC3E015FAAE7898B1F5DE792AE202C9F14DA1F38C50B844C4AA48692B157C7676BD4300E10EF8E5A46F6FF89DA2C840CA837889CADE40E181009E76861A94B7FBEA75AB7E59C21EB9ABCD065E6AB21B5B8AE283C3B95CF34C9AB5C1EEBA7E2FC52C4D15DCCCA4CC91F3FF9712A026D4D6C9FDD13B104D52F1DCFA48C039A19D0CCC74279DB930B1E3A5B2CC96350D98F71C09CA4096621EA9DB8DF59C874CB2BAD6FC82B9068CB1B0E06C7A68F0D6FEC3B87AD47118A89563BFA397B082BD571FFB0BD1457501659625AAF85FAA09AE194AE53E3DCB6DE72BECD9E41D0C55E8069B0373C35649479D3A0E8482BF3E66F8F6D656C6DA7D74F4219CD86841228B3ACB45DEAC8DD2A80F5D0E0E55343395D781BC68BF1154912AC0D8D71A378E2F8F9AC317DE7EFDF91A35C8617C88EC65C595B69C24A4796609CA26AB4F4920AA9B0A69039D125641A4616592B5D37E452A9AA959176A0CA0C2BC9F5E7C69D1874A6488DD925BA116179CE3C0233B2365F36DC114644479F98C62C8DF8A65EB38D3BAFFC4DFEFC892D61EC19869B88781624466A9A00F782BFB829FBC39FDFF8FDE1DFC0F7D6F06F92D0EAAA4D41AD83D70F67BB0E75C4B4ACB09D712B0F7B0547174D03958EE26923D02B9EB98CAEA86A042ABDFB99547484034DDADB18AC7721CD869399D483563564F571D46C2976B4ADCE629254B9567518A3938C8BAABE7B9BB5CA7C4EE23AE8FB0B228C25DE5F4B05D140130CFC5FD99451CCEE9AE08A70BA00A9F289DEC5EDF2C4D88EFF3B9BAA2765C8FAACABAFBE93500DE9AEA17DCB96C15F88089E89F82622AB6F9B92FEF10EF83650EC5CC05E07AB5E5B57889F55AFADAB6BD77A323CB746FE190F6135717FCB9846CEECE7A792EFC8B911780347CED0F9FDB0981FB668353ACD7EBB903D901FB2A161A281D07940189648A9041649ABDDDEE2D61DD084B096CD7687E893BD1ABF4A9E79720E09709D962DB7FA28DAD60A2BA9C635DAE5FB9EDBA63DE5F75827376F9379F3C01B31D781CD9371C362D5B9696E5E34BB24772F7D5F70096D79DFD82D76AE9DF6AEFA65164DBBED63C6345E7563B24ABAAC45E8498643D0CA958A66C6177199B48645258951CFAE40112C86E44C28BA2081C2E300A4CC5E7F3D129622C945348770C66F5295A40A5D8668CE5AAFD374EA6FD39F6DD36D9BC73749F6AAEADF7001CDA4BA9EDFF01F52CAC2CAEE4BBB9E6F12A1EF54D1B9742C95EE60CB7525C97EF3BB4950015F550AEE214A180A9337DC272F70886D0F123EC19204EB727ADB2C647720DAB08FCF29590A12C94246CDAF7FBEF1F4EF371FFE060B8B13A8F1190000 , N'6.4.4')
END

IF @CurrentMigration < '202207212335570_AddClassifcationToVideoTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [int] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207212335570_AddClassifcationToVideoTable', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400E5595B6FDB36147E1FB0FF20E8691B52CB4E5FB6C06ED1B94961AC4E822829F656D0D2B1438CA234920AEC0EFB657BD84FDA5FD8A144DD48F9DADB80A140619187E7FAF15C987FFEFA7BFC729D30EF0984A4299FF8A3C1D0F78047694CF96AE2E76AF9EC47FFE58B6FBF195FC6C9DA7B57D13DD7747892CB89FFA854761104327A8484C841422391CA74A906519A04244E83F3E1F0A760340A0059F8C8CBF3C67739573481E2033FA7298F20533961F3340626CD3AEE840557EF9A24203312C1C47F47E30F1BDF7BC52841E121B0A5EF11CE534514AA76F120215422E5AB30C305C2EE371920DD92300946E58B86FC50ED87E75AFBA03958B18A72A9D2E44886A3E7C61D817DFC24A7FAB5BBD06197E858B5D156174E9BF86F800BB4DC96743165425319870E0AB233AFF838AB038D78D0FFCEBC69CE542E60C2215782B033EF365F301AFD029BFBF437E0139E33D6D60335C1BDCE022EDD8A3403A13677B034DACD62DF0BBAE702FB607DAC75A6547DC6D5F373DFBB46E164C1A00E73CBCC50A502D0381044417C4B94028151BA4E3938922D39FAFF4A12620A6F84EFCDC9FA2DF0957A9CF8F8D3F7AEE81AE26AC5487FE0142F101E5222B7848C83263E3BA3867180747FD40AB2FF4FD46631148EFA0A917385DC010322E1356A58C9D2BFEFA996ED18B79BD7941129E99246260B18D531B90DECAD7D9CAFC9135D15B4960C930850ED62573ED2CC882850F4DEEC5F8934B94B5985C172F97D98E622D276A6EEDE3D112B5087023D4F5A30B78D9BC92B46564DBEDE87FFEEF98FBC0818FE1804DB205CDA40EDBA770EC90284513FA40C4BA7EFBD232CC7CFA1138C0EF59B94C535ED6837EDAD0E12FAAAA63F77FD5B7AB2BDF84ACA34A2852FDA79C484B62BEE92C7DE8E38370034A9688E2EA4193A0DA33AF17F70D4EFE75761A3C5CFE0ACCB6F38188C6C0B5BD6B8B9125B064528AF1D56445E2FC25AF5E006DB02031D696EB7ADBD661A826A5F16E97B0D8ABBDA3BC6778F172EE83B6E9C691D6F596AF1A86E658BA2E7D2DA197B776C6B651B3D83C33854D16C71A81C659783AE493D99A10E60D3EC0565B7577585C196B6703C27598697B4D5269A152F2C7BC4E9B3F0F84E2A29790491EC69A86A6D6B4958A1C80AAC5D148D9A5E512115D602B2203A894DE3C421EBC0750B962A511D44BA81AA105691EBDFAD3B31E88548E3B32B3423C1B25A58047664DD7345534E18113DF57D9AB23CE1DB7A845DA7CB8ADD3E5FAEB81CC681A5B8ED91C07189054DDBC107B9DFDC94E3DD5FDEF8E3DDBFE5DCD776FF360E9D6EA8CDA8B371383FBB3368B3B4F7BE3C48BAD9AD072955DEEE4543B57950C8752AB67CD393925D0F1C849292471F56B4076AB9C7A964EACC892A1DAD0C66D198162DCF4CEAE6B86E1E0F31D42E546EB49D7A6593D458ABEB96559FC6A656EC7FDB708A4749E27B68FB137A180B47B8910A9281261884BFB329A388EE86604E385D8254655BEB9F0F47E7D65BC97FE7DD22903266873C5E7CF109956A971E39C2B5674EFE4444F448C47709597FDFE6F4D12F025FC7157BC7F12FE3AB8366F0187FAB4F37839F028526D9B4783823C90CA7CDF5C4FFA33874E1CD7E7D5F9D3BF36E04DEE50B6FE8FD791A7A4E1B045B35EBB859CD1D184E992011B22034A208C3642B7150A76EE1BE1594473423ACA3B35B6B0EB907DA7F353F7BE73564C035C03B661D22685751ADB95A17729FED474EC3EE1472C0B8BB7DDA2DCB10DEAD850E6C09C62D835FEF24BC7D10EEE3DC3F947EC621B9637D6BF6D93B16BBB3F4E71984DD060211D3FA130A8255D255C342F7441CA20E566A9A195FA615682D8D2A122B9FCD41114CABE4955074492285DB1160AED4CFAAE679EA3259403CE337B9CA72852643B2609D675A0DFD5DF28B69BFABF3F8262B1E2A3F8509A826D595E186FF9CD3D633DC959BCFB7B1D077CAD4401D4BA56BE16A537372FFA2B08D91715F9D0AEE21C9183293373C244F708A6E0F12DEC28A449BAA0FDCCE647F20BA6E1FBFA6642548220D8FE63C7E2286E364FDE25FA59DE2CB491C0000 , N'6.4.4')
END

IF @CurrentMigration < '202207251804119_4thIteration'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Videos_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [PK_dbo.Genres]
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Id';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Id] [tinyint] NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var2 nvarchar(128)
    SELECT @var2 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var2 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var2 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var3 nvarchar(128)
    SELECT @var3 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Classification';
    IF @var3 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var3 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Classification] [tinyint] NOT NULL
    DECLARE @var4 nvarchar(128)
    SELECT @var4 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var4 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var4 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [tinyint] NOT NULL
    ALTER TABLE [dbo].[Genres] ADD CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_GenreId] FOREIGN KEY ([GenreId]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207251804119_4thIteration', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400D5595F6FDB36107F1FB0EF20E871482DDB45812DB05BA44E5218AB93204A8ABD15B47476885194465281DD619F6C0FFB48FB0A3B4AD43F4AB21DB7CD5A14282CF2EE78FCF177C73BE6DFBFFF99BCD944CC79042169CCA7EE6830741DE0411C52BE9EBAA95ABDF8D97DF3FAC71F261761B4713E14722FB51C6A7239751F944A4E3D4F060F1011398868206219AFD42088238F84B1371E0E7FF146230FD0848BB61C67729B724523C83EF07316F300129512B6884360D28CE38C9F5975AE48043221014CDD0F34FCB4759D3346092EEE035BB90EE13C5644A16BA7F7127C2562BEF6131C20EC6E9B00CAAD0893605C3EADC40FF57E38D6DE7B9562612A48A58AA3271A1CBD347078B6FA51A0BA255C08D80502ABB67AD7196853F71D70813BB7573A9D31A1A50CA0834CECC4C93E4ECA83463EE87F27CE2C652A1530E5902A41D88973932E190D7E85ED5DFC3BF0294F19ABFB819EE05C6300876E449C8050DB5B5819EFE6A1EB784D3DCF562CD56A3AB9EB6FB70AB776856B932583F294BD9DEAFAFFC200520589EE3A0BB2790F7CAD1EA6EEF8D52BD7B9A41B088B1163F59E538C0B5452223D60D52BF248D719D4D6FA0831C4D2756E8165D3F28126399107D9D447736297228E6E635668E4C31FEF88588342FFE3F69C1FA722B03C9978152376F22433B49F2799D8F7C69339572FC71D4756DBA6AF6201082308A220BC214A81E0DA0664407D23A4B256450A0191704E54B9B8FE7D47A3A7DBCA28F499A13563444ABAA2814966060F4D6D7BEAE8F031D1715CF41411D2153D45641D163D69548B1D7B737379C9C8BABA76F6055553FF33A30B391582605BE460ED289BE82E205A8230DEFB946101E03A1F084BF173D83A8B86F4BB9885A5EC68B7EC8D3E2384AA941FB7E1CD81AC0F9E4919073483A29E9BCCC93697BBE0A1B3E3982BFE99F4B64004698298E1A14EDD9F5AEE77DB2B936E65CFD0AC696FE4DA99EC9A9F638C2A70CE82BC3C98111990B0CD7744226C8E60F203A1B30F61581F493C70CA553B53521ED084B07EAF2D9503D3AB76A9346ECF9C43025C67C67EEC0F59B54C39EDA5CB152C94F68132F16AEC69DF77A8A350A3246816687A1036AA234CB19834912A4D86B6D9A28DFAA0EA1BC2ABBD4A1A4DB6B4C8D6542F2A8396BA21AFA55EDBA965A3488235898E1C6983BE3B964A672B3F5BC7B63B7A6A160AA0EC20686EA92311970758B5085EDE2314BD84D7D34C4C1624493027D69A0B33E2F87967317BE13FBDFE8E721B5E203BCAF0D2DB7225AC32C81AAC595C1A3DBDA4422ABCBEC992E83B6316462DB1065D7BB8542CD56064FBA00A8615E2FA772D26069D14A930BBC46D443A016475937DB26DBDAC95238C888E1A6D16B334E2FD89A85F3BAFBAEAFAF948DBC2C4B31C6F659C1624ADFCDC04F820F84DA43C1DFE3CE29F0E7F8FDEFF0D7F9F8546015B37D49838DC5E79A3D46DF55E33FD76EC82AE6ECE9E7B66B2B532A12D52AE5E66442BF34D4C16DAFFD6D24A4BB988EB205C8FC8344C49FE562A88065A60E0FFC1668CE27E2B8105E1740552E5F5A93B1E8EC6D6DBCDB7F38EE24919B2431E539EBD7FC5221ACB79F5594F1DFC9188E08188765FBAD3E813DF0F9E1D9A0C96BDCDFBF3E37650B31EE26FF5059AF5921FAD0A768E45F466EAFE99E99D3AF3DF3E1AD513E75A607C9E3A43E7AF2FD4E71FC6D23E421DD7F59942F7591B33ABCA3DA6CD3CAAB7EB2BC9BE4E3BF79D7470EDCAF98016ADBF43CB2F388CCCA53ED79CC43DCD4A67F7D6DFBC7559EE6EA4BE6263D7D87DAD5EDFDBCAB5FBBFAFD3BCB54B13644CED8F45C85549D79509FDA7230E41832BA5CC9CAFE282B39647858895D816A00826657226145D9140E1740098EAF473AE79C2BA889610CEF975AA9254E196215AB2C6F3B0A6FEAEF5B30EB5E9F3E43AC9DE32BFC416D04DAAEF956BFE36A5B5A7BACB8E54DC6342C794B94DF5592A7DABAEB7A5A5AB981F68C8C057A6823B881286C6E435F7C9231CE3DBBD84F7B026C1B6A830FB8DEC3F8826EC93734AD68244D2D8A8F4F113391C469BD7FF01BD46EE03331D0000 , N'6.4.4')
END

IF @CurrentMigration < '202207251850024_5thIteration'
BEGIN
    CREATE TABLE [dbo].[Tags] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Tags] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoTags] (
        [VideoId] [int] NOT NULL,
        [TagId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoTags] PRIMARY KEY ([VideoId], [TagId])
    )
    CREATE INDEX [IX_VideoId] ON [dbo].[VideoTags]([VideoId])
    CREATE INDEX [IX_TagId] ON [dbo].[VideoTags]([TagId])
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Videos_VideoId] FOREIGN KEY ([VideoId]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Tags_TagId] FOREIGN KEY ([TagId]) REFERENCES [dbo].[Tags] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202207251850024_5thIteration', N'Vidzy.Migrations.Configuration',  0x1F8B0800000000000400ED5ADB6EE336107D2FD07F10F4D41659CBC9628136B07791759222E8E68238BBE8DB829168872845A92215D82DFA657DE827F5173A942859E2C5961CC77B41B1C0222639C3E1E1991972A87FFFFE67F4661153EF11679C246CEC1F0E86BE8759984484CDC77E2E662F7EF4DFBCFEF69BD159142FBC0FD5B897721C48323EF61F84488F8380870F38467C1093304B783213833089031425C1D170F8537078186050E1832ECF1BDDE64C9018173FE0E72461214E458EE8651261CA553BF44C0BADDE158A314F5188C7FE0712FDB1F4BD134A104C3EC574E67B88B1442001A61DBFE7782AB284CDA72934207AB74C318C9B21CAB132F97835BCABF5C323697DB012AC5485391749DC53E1E14B0547A08B6F05AA5FC305809D01B06229575D8036F67FC62C8395EB331D4F682647294007C5B003AFF871506F34F041FE3BF02639157986C70CE72243F4C0BBC9EF29097FC1CBBBE437CCC62CA7B4690758027DAD0668BAC992146762798B67CABA8BC8F782B65CA00BD6620D99D2F4B74B014BBB82B9D13DC5F52E076BC5E5FF9502A00A10DDF72ED1E21D6673F130F68F5EBDF2BD73B2C051D5A2B4BE6704FC028444967798F50A3D927901B5363F408C13EE7BB79816DDFC81A425910745D747B563E75912DF26B492289B3FDEA16C8E05D89F987DD324CF42CD9251B062C45A9E148A36F3A418F6A5F1E482899747962D6B2C732A920C038C384302473748089C31A90317407D26A4D266050A61C4F12912F5E4F2EF3B12F7D75550E889AE35A188733223A10A660A0F496DBD6B6BF751DEB19DF7541E62F39ECAB3BA1A7287E6EBBCB8ECD6CD90AD0E2B8A2E9B119D5D18346C766018F4BFFBF6745FF8B393FBEE2C05AC218F3D01B478D58D3C79DCA08EEE9E17FC9C82CA7AA19B58D5967F22C100D608677409DBD008466D6C2F717C8F3365FD945038C2FADE074473F8393476A235FAE78446F5D8C3F5636FE4060154F5F82313DE12C866E309E749480A289A3BAE62537BBA3316796B02D52A82AA047D0908921430834D1DFB3F18E6DBF5D5AC59E95381B2ADEFD0D79DF99A9D429611D83B09CB03EE04F1104526DB0189A8DD02FE8F33E98088C2099FC3861326CC604158485244DD566B221D238C34A956AEF79CE21433191CDCD87799B54E9AE6D4F50C1A4A9B4019050DF6742155112BD673A09D759E4CA9761C5AA92BF2CF5A65CEC595410A00110047ED7D4514918D78212C3108EE7A2A0C71158175BBA5D22916CDDD82B8BA8A886D573096DD16AFA2B621AE60DC205EC67443B8004D136D80A44D5F1D6F1A232CA71F9D8CEB634C6DE86A89069DD7479586860A633D38B497D479B92568AED59AD4DF44FE6DD6DAA27B4341695BE7855699B826F9AACA1194658EAA1C1238EA21A34B94A690141BF511D5E24DCBE2C8E4C5B47F09212E750421B754126A6BEB99E0A485E658EB85A9C1D2739271013710748FE4A16112C5C6B0964B3B1CA69AAAE5B5E62E558E540D977F37E2C6C0EA0B2BCCCE6119B1CC00C5D951A7B0295754A3104599E59C3A49681E337726724B9727CFA67CD9626A18059AE146CA31203112741BE04EF02B37E90F7F1915FBC3EF90FBD4F0BB34B4EEE04D45AD8EEEFAEA23455397F39CE1D6A39FE89BEAF4BECF866C8E80BE896A3287F6279A55EA53D3ECB9816FA7278BABAB946BF566D567F5580B9A3293DA6EBEAD946C22D009FF4291FDE4DD98B59741CEDB46278340453F73F4A382B95DC689411F5293A53E3968278491CAD69B9F558CF45D0EF13DB0FD113082D43D5D7281E3811C3098FE4E2794003D57032E112333CC457991F78F868747DA33CDE7F36412701ED12EEF267BAF7509C29644C2FA84570DF688B2F0016566097AADD29E4F057B87A6806563A16FFFB875AACB47F0B7D8415DBEE687711BBE60115E8CFD3F0BB963EFE2D78F4AF4C0BBCEC03F8FBDA1F7D78E4AFADD58DAAB70FDF5D2E9BB182DBE6F6A328BC5FD5C6F4BB8DC29D31C6BCD669BD1ADA76840DC81A84AEC49445516F79BB810EA31AD6B9FB62BF8AA5ACE5E6BB25A71639B72E056655DD765FC792AB95F54F1D67A12EEBF51CF4993A248A91BB0B9DCFBA43780BD91C57E7BEC133FF7CC17DB45A5B163FA6659F6E92BE24AD7DDDB27539C77C19DF3C4FE6E62D6621DD597F63715AE7791F22A0867D87B1986CAE4E8A8F35BDF4CDC4F2636CDF6BABCED39C5F59A62D36A2DD65BADB52B5E75396DB64EF17C4F39AD4D6B14AE373E6898AF203B7DAEA9DF5AD6BDDA38AA3FFD4D75C41F5B756AA78BACDE83D62ED25E51D243B55692DCC7027BBC4599152408578DCF77215272325FA9901FF3321CB602553DE682CD922A5C6A165543B463FD251608EECEE8241364864201DD21861BA9FC42477D927116DFE3E8825DE722CD052C19C7F7B4F5C58F8CBBEBE62F1EDCDA368FAED3E2C39C5D2C01CC24F2FA7FCDDEE6A4F1E9C9B9E57EE1502103BABAA5CABD14F2B63A5FD69AAE12D6519182AFCE4377384E2928E3D76C8A1EF136B6BDE7F81D9EA370591502DD4A366F441BF6D12941F30CC55CE958C9C34FE070142F5EFF07EF78BCE1C52E0000 , N'6.4.4')
END

